generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Event {
  id                 String     @id @default(uuid())
  name               String
  slug               String     @unique
  description        String?
  eventDate          DateTime
  location           String?
  latitude           Float?
  longitude          Float?
  gpxFile            String?    // Path to GPX route file
  status             String     @default("upcoming") // upcoming, ongoing, completed
  isActive           Boolean    @default(true)
  cutoffMs           Int?       // Cut off time in milliseconds (null = disabled)
  categoryStartTimes Json?      // JSON object: { "10K Laki-laki": "2025-11-23 07:00:00.000", ... }
  categories         Category[]
  banners            Banner[]
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @updatedAt
}

model Category {
  id        String   @id @default(uuid())
  name      String
  eventId   String
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
  order     Int      @default(0)
  createdAt DateTime @default(now())

  @@unique([eventId, name])
  @@index([eventId])
}

model Banner {
  id        String   @id @default(uuid())
  eventId   String
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
  imageUrl  String
  alt       String?
  order     Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())

  @@index([eventId])
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("admin")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
